"use strict";(self.webpackChunkswarmcloud_docs=self.webpackChunkswarmcloud_docs||[]).push([[1324],{5680:(e,r,t)=>{t.d(r,{xA:()=>u,yg:()=>d});var n=t(6540);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach(function(r){o(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function s(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=n.createContext({}),c=function(e){var r=n.useContext(l),t=r;return e&&(t="function"==typeof e?e(r):a(a({},r),e)),t},u=function(e){var r=c(e.components);return n.createElement(l.Provider,{value:r},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},y=n.forwardRef(function(e,r){var t=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(t),y=o,d=p["".concat(l,".").concat(y)]||p[y]||g[y]||i;return t?n.createElement(d,a(a({ref:r},u),{},{components:t})):n.createElement(d,a({ref:r},u))});function d(e,r){var t=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=y;var s={};for(var l in r)hasOwnProperty.call(r,l)&&(s[l]=r[l]);s.originalType=e,s[p]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=t[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,t)}y.displayName="MDXCreateElement"},7369:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>u,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>c,toc:()=>p});t(6540);var n=t(5680);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function i(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}),e}function a(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}const s={title:"Usage",sidebar_position:2,slug:"/"},l=void 0,c={unversionedId:"usage",id:"usage",title:"Usage",description:"Prerequisites",source:"@site/docs/media/usage.mdx",sourceDirName:".",slug:"/",permalink:"/home/media/",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Usage",sidebar_position:2,slug:"/"},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/home/media/introduction"},next:{title:"API & Config",permalink:"/home/media/API"}},u={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"CORS",id:"cors",level:3},{value:"OPTIONS REQUEST",id:"options-request",level:3},{value:"RANGE REQUEST",id:"range-request",level:3},{value:"Register your Domain",id:"register-your-domain",level:4},{value:"Secure your Site with HTTPS",id:"secure-your-site-with-https",level:4},{value:"Host Service Worker",id:"host-service-worker",level:2},{value:"If you don&#39;t have a Service Worker",id:"if-you-dont-have-a-service-worker",level:3},{value:"If you already have a Service Worker",id:"if-you-already-have-a-service-worker",level:3},{value:"Integrate P2P Engine",id:"integrate-p2p-engine",level:2},{value:"Player Integration",id:"player-integration",level:2}],g={toc:p},y="wrapper";function d(e){var{components:r}=e,t=a(e,["components"]);return(0,n.yg)(y,i(function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){o(e,r,t[r])})}return e}({},g,t),{components:r,mdxType:"MDXLayout"}),(0,n.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.yg)("h3",{id:"cors"},"CORS"),(0,n.yg)("p",null,"Make sure your streaming servers have proper CORS (Cross-origin resource sharing) headers so that data can be fetched across domain."),(0,n.yg)("h3",{id:"options-request"},"OPTIONS REQUEST"),(0,n.yg)("p",null,"OPTIONS requests are mandatory to be able to perform RANGE requests in a cross-domain environment. The general idea is to add the following header to the HTTP response:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},"Access-Control-Allow-Methods: GET, OPTIONS\n")),(0,n.yg)("h3",{id:"range-request"},"RANGE REQUEST"),(0,n.yg)("p",null,"RANGE requests is required by P2P. Add the following header to the HTTP response:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},"Access-Control-Allow-Headers: Range\n")),(0,n.yg)("h4",{id:"register-your-domain"},"Register your Domain"),(0,n.yg)("p",null,"Register your domain at ",(0,n.yg)("strong",{parentName:"p"},(0,n.yg)("em",{parentName:"strong"},(0,n.yg)("a",{parentName:"em",href:"https://oms.cdnbye.com"},"https://oms.cdnbye.com")))),(0,n.yg)("admonition",{type:"tip"},(0,n.yg)("p",{parentName:"admonition"},"Localhost is always whitelisted. This means that you do not have to configure anything to perform tests locally.")),(0,n.yg)("h4",{id:"secure-your-site-with-https"},"Secure your Site with HTTPS"),(0,n.yg)("p",null,"Secure your site with HTTPS, if it isn't already. HTTPS is required for Service Worker, which we'll set up in the next step."),(0,n.yg)("p",null,"To secure your site with HTTPS, you can use ",(0,n.yg)("a",{parentName:"p",href:"https://letsencrypt.org/"},"Let's Encrypt")," for a free certificate and easy integration. See Let's Encrypt's starting instructions ",(0,n.yg)("a",{parentName:"p",href:"https://letsencrypt.org/getting-started/"},"here")," to secure your site."),(0,n.yg)("h2",{id:"host-service-worker"},"Host Service Worker"),(0,n.yg)("p",null,"To maintain a high-security standard, foreign software to be integrated into the browser with the help of ServiceWorkers is not allowed. This is only possible if the software is hosted on the same server as the web page. So the ServiceWorkers only work if they are hosted under the same domain as the main page, meaning that a client running a website needs to host our web SDK on his own servers instead of getting it from our public cloud."),(0,n.yg)("h3",{id:"if-you-dont-have-a-service-worker"},"If you don't have a Service Worker"),(0,n.yg)("p",null,"Copy ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/swarm-cloud/media-p2p-engine/blob/main/demo/sw.js"},"sw.js")," to your server and make it available at ",(0,n.yg)("strong",{parentName:"p"},(0,n.yg)("em",{parentName:"strong"},"https://your_website.com/sw.js"))," ."),(0,n.yg)("h3",{id:"if-you-already-have-a-service-worker"},"If you already have a Service Worker"),(0,n.yg)("p",null,"Integrate media-proxy.js into your existing Service Worker by adding this code to the beginning of your Service Worker's root JavaScript file:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-javascript"},"self.importScripts('https://cdn.jsdelivr.net/npm/@swarmcloud/media/media-proxy.js')\n")),(0,n.yg)("p",null,"Once added, 1) your existing Service Worker will continue to be installed, and 2) SwarmCloud's imported Service Worker script will handle CDN 'fetch' events to intercept MP4/MP3 request. All 'fetch' events not handled by SwarmCloud's Service Worker will fall through to your existing Service Worker's 'fetch' event handler(s)."),(0,n.yg)("h2",{id:"integrate-p2p-engine"},"Integrate P2P Engine"),(0,n.yg)("p",null,"Add the following line as early as possible to the ",(0,n.yg)("inlineCode",{parentName:"p"},"<head>")," tag of your index.html, you can pass any of the Client Config options to the P2PEngineMedia class constructor:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-html"},'<script src="https://cdn.jsdelivr.net/npm/@swarmcloud/media"><\/script>\n')),(0,n.yg)("p",null,"Or via npm"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ npm install @swarmcloud/media\n")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-javascript"},"import P2PEngineMedia from '@swarmcloud/media';\n\n// Create P2PEngineMedia instance...\nvar engine = new P2PEngineMedia({\n    // logLevel: 'debug',\n    // swFile: './sw.js',     // you may need to change it to the actual path of sw.js\n    // trackerZone: 'hk',        // if using Hongkong tracker\n    // trackerZone: 'us',        // if using USA tracker\n    // token: YOUR_TOKEN\n    // Other p2pConfig options provided by P2PEngineMedia\n})\n// get the proxied playback url\nengine.getProxiedUrl('http://example.mp4').then((url) => {\n    video.src = url;\n})\n")),(0,n.yg)("h2",{id:"player-integration"},"Player Integration"),(0,n.yg)("p",null,"You can use this SDK for clappr, videojs, jwplayer and so on, see ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/swarm-cloud/media-p2p-engine/tree/main/demo"},"here")))}d.isMDXComponent=!0}}]);